---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
df<-read.csv("activity.csv")
###process as date
df$date<-ymd(df$date) 

## What is mean total number of steps taken per day?
install.packages("dplyr") 
### using dplyr to process data for the histogram
library("dplyr") 
###intermediate step to subset what I needed
i<-df[,1:2] 
 e<-i%>% 
  group_by(date)%>% 
  summarise_each(funs(sum, mean)) 
 e$interval<-NULL
### the histogram
hist(e$steps) 
dev.off()
### estimating the mean, which turned out to be 10766.19
mean(e$sum, na.rm = T) 
### and the median, which turned out to be 10765
median(e$sum, na.rm = T) 

## What is the average daily activity pattern?
library("dplyr")
f<-df%>% 
  group_by(interval,date)%>% 
  summarise_each(funs(mean)) 
hist(df$steps)
### mean is 37.07588
mean(df$steps)
### median is 0
median(df$steps)

library("ggplot2")
with(df, plot(interval, steps))
ggplot(data=f, aes(x=interval, y=steps, group=date)) +
  geom_point(aes(color=date)) + 
  geom_line(aes(color=date))
dev.off()
which.max(f$steps)
f$interval[4633]#615 is within the interval with the maximum number of steps

## Imputing missing values
library("mice") # takes care of all thing NAs
md.pattern(df)#1526 observations are complete, Steps have  2304 NAs
tempdf<-mice(df[,c(1,3)], seed=100) #mice creates tempdf to take care of NAs
tempdf$imp$steps # vector to impute NAs to steps
completedf<-complete(tempdf,1) # get back the completed dataset using the complete() 
dim(completedf) #check the dims of both before passing on the imputed values
dim(df)
df$steps<-completedf$steps passing on the imputed values

## Are there differences in activity patterns between weekdays and weekends?
### converts to the name of the day
df$date<-weekdays(df$date, abbreviate = F) 
### dplyr to get average number of steps taken,  across all weekday days or weekend days
library("dplyr")
g<-df%>% 
  group_by(interval,date)%>% 
  summarise_each(funs(mean))  
### logical vector for wkdy or wknd
g$logical<-ifelse(g$date=="Saturday" | g$date=="Sunday", "wknd", "wkdy") 
library("lattice")
par(mfrow=c(2,1))
###  a time series plot 
xyplot(steps ~ interval | logical, type="l", data = g, layout=c(1,2))
dev.off()    
